## ❗ `dev` 分支正在开发中，极不稳定。`master` 分支是更稳定（但功能更少）的版本。

# Redstone Computer Utilities

> 一些红石计算机调试工具。

[English README](./README.md) | [简体中文简介](./README.zh_cn.md)

## 特性

（待补充）

## 安装

支持 Minecraft 1.19.1，需要安装最新的 Fabric Loader 和 Fabric API。

这个模组主要工作在服务器侧，但必须同时安装在服务器侧和客户端侧来正确显示翻译。

需要安装 Python 3.6 或更新版本来使用 Python 相关功能。

## 用法

### 部件（待开发）

模组提供了不同类型的部件用于与红石和数字信号交互。一些部件以一排标靶的形式存在于游戏内，可以连接红石来接受或发出红石信号。以下是部件的类型：

- 排线（wires）（待开发）
  - 无时钟同步的输入输出接口，实时传输数据（实际上是当方块更新时）。
  - 能连接到排线。

- 总线（bus）（待开发）
  - 有时钟同步的输入输出接口，仅当时钟信号到达时传输数据。
  - 能连接到总线。

- 寻址总线（addrbus）（待开发）
  - 有时钟同步的并要求寻址的输入输出接口，仅当时钟信号到达时同时传输地址和数据。
  - 能连接到寻址总线。

- 随机存储器（ram）（待开发）
  - 可读写的随机存储器，数据存放在游戏内存中。
  - 能连接到寻址总线或从寻址总线连接到。

- 文件随机存储器（fileram）（待开发）
  - 可读写的随机存储器，数据存放在游戏外文件中。
  - 能连接到寻址总线或从寻址总线连接到。

部件可以用 `<类型>:<名称>` 的方式来指定，其中 `<名称>` 是一个由字母、数字和下划线组成的大小写敏感的字符串。例如 `addrbus:Input1` 指定了一个名为 `Input1` 的寻址总线而 `fileram:new_executable` 指定了一个名为 `new_executable` 的文件随机存储器。不同类型或不同玩家的部件可以使用相同的名称。此外，可以但不建议使用与部件类型名相同的名称来命名一个部件。

### 连接（待开发）

所有的部件都可以与其他部件相连来单向传输数据（可以时钟同步也可以不同步）。部件间连接的方向决定了数据流的传输方向。

无法以显然的方式连接的部件必须通过红石线来传输数据以避免歧义。

部件间的连接可以用 `{源部件选择器}->{目标部件选择器}` 的方式来指定。例如 `addrbus:input->ram:ram1` 指定了一个从名为 `input` 的寻址总线到名为 `ram1` 的随机存储器的连接。

### 命令（待开发）

涉及文件操作的命令（即涉及文件随机存储器的命令、`/rcu newfile` 和 `/rcu removefile` 等）的权限等级为 4（因为文件操作相当危险）。这意味着命令方块不能运行这些命令。其他命令的权限等级为 2。

`/rcu`
- 如果有命令在运行则停止正在运行的命令，否则给命令执行者一个魔杖物品（即粉红色染料）。

`/rcu new {部件或连接选择器} [选项...]`（待开发）
- 创建部件或连接。

`/rcu remove {部件或连接选择器}`（待开发）
- 删除部件或连接。

`/rcu info`（待开发）
- 显示简略状态信息。

`/rcu info {部件或连接选择器}`（待开发）
- 显示部件或连接的详细信息。

`/rcu read {部件选择器} [选项...]`（待开发）
- 从部件读取数据。

`/rcu write {部件选择器} [选项...] (<数据> | from {部件选择器} [选项...])`（待开发）
- 将 `<数据>` 或从另一部件读取的结果写入部件。

`/rcu start {部件或连接选择器}`（待开发）
- 启用部件或连接。

`/rcu stop {部件或连接选择器}`（待开发）
- 停止部件或连接。

`/rcu newfile <文件名> <字节数>`（待开发）
- 创建新文件并使用 `<字节数>` 个字节的 0 填充。

`/rcu removefile <文件名>`（待开发）
- 删除文件。

`/rcu asm <指令集> [选项...] <汇编代码> (to {部件选择器} [选项...])`（待开发）
- 汇编指定的代码并将结果写入部件。

`/rcu disasm <指令集> [选项...] (<机器码> | from {部件选择器} [选项...])`（待开发）
- 反汇编指定的机器码或从部件读取的结果。

## 开发

Java 源代码文件位于 `src/main/java/`。Python 源代码文件位于 `src/redstone_computer_utilities/`。

要构建模组，需要安装 Java 17 或更新版本，Pytho 3.7.2 或更新版本和最新的 Poetry。运行以下命令：

```sh
$ ./gradlew build
$ poetry build
```

构建出的 jar 文件位于 `build/libs/`。构建出的 wheel 文件位于 `dist/`。

## 鸣谢

[Py4J](https://www.py4j.org/)，使用 [BSD-3-Clause](https://github.com/py4j/py4j/blob/master/LICENSE.txt) 许可证分发。

## 版权

版权所有 © 2021-2022 NKID00

使用 [MPL-2.0](./LICENSE) 许可证分发。
